<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <title>Project H – Service</title>
  <link rel="stylesheet" href="service.css" />
</head>

<body>
  <!-- ==================== GNB ==================== -->
  <header class="gnb">
    <!-- 로고 아이콘 -->
    <img src="/public/service/gnb_icon.svg" class="gnb-logo-icon" alt="gnb icon" />

    <!-- 메뉴 -->
    <nav class="gnb-nav">
      <a href="about.html">About</a>
      <a href="design.html">Design</a>
      <a href="service.html" class="active">Service</a>
      <a href="about.html#video-section">Video</a>
    </nav>

    <!-- 햄버거 버튼 -->
    <button class="gnb-menu" type="button" aria-label="open menu">
      <svg width="24" height="18" viewBox="0 0 24 18" fill="#56AFDF" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M0 1.5C0 0.671573 0.671573 0 1.5 0H22.5C23.3284 0 24 0.671573 24 1.5C24 2.32843 23.3284 3 22.5 3H1.5C0.671573 3 0 2.32843 0 1.5Z" />
        <path
          d="M0 9C0 8.17157 0.671573 7.5 1.5 7.5H22.5C23.3284 7.5 24 8.17157 24 9C24 9.82843 23.3284 10.5 22.5 10.5H1.5C0.671573 10.5 0 9.82843 0 9Z" />
        <path
          d="M0 16.5C0 15.6716 0.671573 15 1.5 15H22.5C23.3284 15 24 15.6716 24 16.5C24 17.3284 23.3284 18 22.5 18H1.5C0.671573 18 0 17.3284 0 16.5Z" />
      </svg>
    </button>

    <!-- 햄버거 드롭다운 패널 -->
    <div class="gnb-menu-panel">
      <a class="gnb-menu-item" href="https://planner-dabinpark.notion.site" target="_blank" rel="noopener noreferrer">
        박다빈
      </a>
      <a class="gnb-menu-item" href="https://stile.im" target="_blank" rel="noopener noreferrer">
        노권후
      </a>
      <a class="gnb-menu-item" href="https://www.instagram.com/oneul_is_day/" target="_blank" rel="noopener noreferrer">
        심정빈
      </a>
      <a class="gnb-menu-item" href="https://www.behance.net/caf4d781/projects" target="_blank"
        rel="noopener noreferrer">
        오정은
      </a>
      <a class="gnb-menu-item" href="https://ji009868.github.io/portfolio/" target="_blank" rel="noopener noreferrer">
        배준일
      </a>
      <a class="gnb-menu-item" href="https://dmdhyunk.github.io/react-portfolio/" target="_blank"
        rel="noopener noreferrer">
        김지현
      </a>
    </div>

  </header>

  <!-- ==================== SERVICE CANVAS ==================== -->
  <main class="service-wrapper">
    <!-- 타이틀 -->
    <img src="/public/service/title.svg" class="service-title" alt="title" />

    <!-- 온보딩 전체 섹션 이미지 -->
    <img src="/public/service/onboarding.svg" class="service-onboarding" alt="onboarding" />

    <!-- 폰 프레임 -->
    <img src="/public/service/phone.svg" class="service-phone" alt="phone frame" />

    <!-- 홈 섹션 -->
    <img src="/public/service/home.svg" class="service-home" alt="home" />

    <!-- 컨텐츠 섹션 -->
    <img src="/public/service/contents.svg" class="service-contents" alt="contents" />

    <!-- 액티비티 + 커뮤니티 통합 -->
    <img src="/public/service/activity_community.svg" class="service-activity-community" alt="activity & community" />

    <!-- 엔딩 -->
    <img src="/public/service/ending.svg" class="service-ending" alt="ending" />

    <!-- 푸터 -->
    <img src="/public/service/footer.svg" class="service-footer" alt="footer" />

    <!-- ==================== SERVICE CARDS ==================== -->
    <section class="service-cards">
      <div class="service-card card-1">
        <img src="/public/service/card_1.svg" alt="서비스 카드 1">
      </div>
      <div class="service-card card-2">
        <img src="/public/service/card_2.svg" alt="서비스 카드 2">
      </div>
      <div class="service-card card-3">
        <img src="/public/service/card_3.svg" alt="서비스 카드 3">
      </div>
      <div class="service-card card-4">
        <img src="/public/service/card_4.svg" alt="서비스 카드 4">
      </div>
      <div class="service-card card-5">
        <img src="/public/service/card_5.svg" alt="서비스 카드 5">
      </div>
      <div class="service-card card-6">
        <img src="/public/service/card_6.svg" alt="서비스 카드 6">
      </div>
      <div class="service-card card-7">
        <img src="/public/service/card_7.svg" alt="서비스 카드 7">
      </div>
      <div class="service-card card-8">
        <img src="/public/service/card_8.svg" alt="서비스 카드 8">
      </div>
    </section>
    <div class="onboarding-group">
      <div class="onboarding-img onboarding-s onboarding-1">
        <img src="/public/service/onboarding_1.svg" />
      </div>

      <div class="onboarding-img onboarding-s onboarding-2">
        <img src="/public/service/onboarding_2.svg" />
      </div>

      <div class="onboarding-img onboarding-m onboarding-3">
        <img src="/public/service/onboarding_3.svg" />
      </div>

      <div class="onboarding-img onboarding-s onboarding-4">
        <img src="/public/service/onboarding_4.svg" />
      </div>

      <div class="onboarding-img onboarding-s onboarding-5">
        <img src="/public/service/onboarding_5.svg" />
      </div>
    </div>

    <!-- ===== HOME MULTI CARDS ===== -->
    <img src="/public/service/home_1.svg" alt="home 1" class="service-home-img home-1" />

    <img src="/public/service/home_2.svg" alt="home 2" class="service-home-img home-2" />

    <img src="/public/service/home_3.svg" alt="home 3" class="service-home-img home-3" />

    <img src="/public/service/home_4.svg" alt="home 4" class="service-home-img home-4" />

    <img src="/public/service/home_5.svg" alt="home 5" class="service-home-img home-5" />

    <img src="/public/service/contents_text_1.svg" class="contents-text ct-1" alt="" />
    <img src="/public/service/contents_text_2.svg" class="contents-text ct-2" alt="" />
    <img src="/public/service/contents_text_3.svg" class="contents-text ct-3" alt="" />
    <img src="/public/service/contents_text_4.svg" class="contents-text ct-4" alt="" />
    <img src="/public/service/contents_text_5.svg" class="contents-text ct-5" alt="" />
    <img src="/public/service/contents_text_6.svg" class="contents-text ct-6" alt="" />

    <img src="/public/service/activity_1.svg" class="activity-img act-1" alt="" />
    <img src="/public/service/activity_2.svg" class="activity-img act-2" alt="" />
    <img src="/public/service/activity_3.svg" class="activity-img act-3" alt="" />

    <img src="/public/service/community_1.svg" class="community-img com-1" alt="">
    <img src="/public/service/community_2.svg" class="community-img com-2" alt="">
    <img src="/public/service/community_3.svg" class="community-img com-3" alt="">
    <img src="/public/service/community_4.svg" class="community-img com-4" alt="">

    <img src="/public/service/my_1.svg" class="my-img my-1" alt="my 1" />
    <img src="/public/service/my_2.svg" class="my-img my-2" alt="my 2" />
    <img src="/public/service/my_3.svg" class="my-img my-3" alt="my 3" />
    <img src="/public/service/my_4.svg" class="my-img my-4" alt="my 4" />

    <img src="/public/service/titletext_1.svg" class="titletext-img titletext-1" alt="title text 1" />
    <img src="/public/service/titletext_2.svg" class="titletext-img titletext-2" alt="title text 2" />
    <img src="/public/service/titletext_3.svg" class="titletext-img titletext-3" alt="title text 3" />
    <img src="/public/service/titletext_4.svg" class="titletext-img titletext-4" alt="title text 4" />
  </main>

  <script>
    // 카드 호버 인터랙션
    window.addEventListener("DOMContentLoaded", () => {
      const cards = document.querySelectorAll(".service-card");
      if (!cards.length) return;

      const updateActive = (activeCard) => {
        const viewportCenterX = window.innerWidth / 2;

        cards.forEach(card => {
          if (card === activeCard) {
            const rect = card.getBoundingClientRect();
            const cardCenterX = rect.left + rect.width / 2;

            // 중앙 쪽으로 15% 정도만 이동
            const deltaX = viewportCenterX - cardCenterX;
            const shiftX = deltaX * 0.15;   // 비율은 필요하면 바꿔도 됨

            card.style.setProperty("--card-shift-x", `${shiftX}px`);
            card.style.setProperty("--card-shift-y", `-40px`);
            card.classList.add("is-active");
            card.classList.remove("is-blur");
          } else {
            card.classList.remove("is-active");
            card.classList.add("is-blur");
          }
        });
      };

      const resetCards = () => {
        cards.forEach(card => {
          card.classList.remove("is-active", "is-blur");
          card.style.removeProperty("--card-shift-x");
          card.style.removeProperty("--card-shift-y");
        });
      };

      cards.forEach(card => {
        card.addEventListener("mouseenter", () => updateActive(card));
        card.addEventListener("mouseleave", resetCards);
      });
    });

    (function () {
      const gnb = document.querySelector('.gnb');
      if (!gnb) return;

      let lastScrollY = window.pageYOffset;
      let ticking = false;

      function handleScroll() {
        const currentY = window.pageYOffset;
        const diff = currentY - lastScrollY;

        // 아래로 일정 이상 스크롤하면 → GNB 숨김
        if (diff > 10) {
          gnb.classList.add('gnb--hidden');
        }
        // 위로 일정 이상 스크롤하면 → GNB 보이기
        else if (diff < -10) {
          gnb.classList.remove('gnb--hidden');
        }

        lastScrollY = currentY;
        ticking = false;
      }

      window.addEventListener('scroll', () => {
        if (!ticking) {
          window.requestAnimationFrame(handleScroll);
          ticking = true;
        }
      });
    })();

    // HOME 카드 스크롤 애니메이션
    (function () {
      const homes = document.querySelectorAll(".service-home-img");
      if (!homes.length) return;

      // 대략 가운데 카드인 home_3를 트리거로 사용
      const trigger = document.querySelector(".home-3") || homes[0];

      let visible = false;
      const STAGGER = 120; // 카드 순차 등장 간격(ms)

      function showHomes() {
        if (visible) return;
        visible = true;

        homes.forEach((el, idx) => {
          // 순서대로 딜레이 주기
          el.style.transitionDelay = `${idx * STAGGER}ms`;
          el.classList.add("is-visible");
        });
      }

      function hideHomes() {
        if (!visible) return;
        visible = false;

        homes.forEach((el) => {
          el.style.transitionDelay = "";
          el.classList.remove("is-visible");
        });
      }

      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.target !== trigger) return;

            if (entry.isIntersecting) {
              showHomes();
            } else {
              hideHomes();
            }
          });
        },
        {
          threshold: 0.3, // 해당 영역이 30% 정도 보이면 발동
        }
      );

      observer.observe(trigger);
    })();

    (() => {
      const texts = document.querySelectorAll(".contents-text");
      if (!texts.length) return;

      function handle(entries) {
        entries.forEach(entry => {
          const el = entry.target;

          if (entry.isIntersecting) {
            el.classList.add("is-visible");
          } else {
            el.classList.remove("is-visible");
          }
        });
      }

      const observer = new IntersectionObserver(handle, {
        threshold: 0.35
      });

      texts.forEach(el => observer.observe(el));
    })();

    (() => {
      const items = document.querySelectorAll(".activity-img");
      if (!items.length) return;

      const io = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          const el = entry.target;

          if (entry.isIntersecting) {
            el.classList.add("is-visible");
          } else {
            el.classList.remove("is-visible");
          }
        });
      }, {
        threshold: 0.25
      });

      items.forEach(el => io.observe(el));
    })();

    (() => {
      const comItems = document.querySelectorAll(".community-img");
      if (!comItems.length) return;

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          const el = entry.target;

          if (entry.isIntersecting) {
            el.classList.add("is-visible");
          } else {
            el.classList.remove("is-visible");
          }
        });
      }, { threshold: 0.3 });   // 30% 보이면 등장

      comItems.forEach(el => observer.observe(el));
    })();

    (() => {
      const items = document.querySelectorAll(".my-img");
      if (!items.length) return;

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            // 그룹 전체 순차 등장
            items.forEach((el, index) => {
              el.style.transitionDelay = `${index * 0.15}s`;
              el.classList.add("is-visible");
            });
          } else {
            // 다시 사라질 때 delay를 초기화해야 순차 재등장 가능
            items.forEach(el => {
              el.style.transitionDelay = "0s";
              el.classList.remove("is-visible");
            });
          }
        });
      }, {
        threshold: 0.25
      });

      items.forEach(el => observer.observe(el));
    })();

    (() => {
      const items = document.querySelectorAll(".titletext-img");
      if (!items.length) return;

      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          const el = entry.target;

          if (entry.isIntersecting) {
            // 화면에 들어오면 서서히 나타남
            el.classList.add("is-visible");
          } else {
            // 화면에서 벗어나면 다시 사라짐
            el.classList.remove("is-visible");
          }
        });
      }, {
        threshold: 0.25   // 요소의 25% 정도 보일 때 트리거
      });

      items.forEach((el) => observer.observe(el));
    })();

    (function () {
      const menuBtn = document.querySelector(".gnb-menu");
      const panel = document.querySelector(".gnb-menu-panel");

      if (!menuBtn || !panel) return;

      // 햄버거 클릭 -> 열고 닫기
      menuBtn.addEventListener("click", function (e) {
        e.stopPropagation();
        panel.classList.toggle("is-open");
      });

      // 패널 안 링크 클릭 시 자동 닫기
      panel.addEventListener("click", function (e) {
        if (e.target.matches(".gnb-menu-item")) {
          panel.classList.remove("is-open");
        }
      });

      // 바깥 영역 클릭 시 닫기
      document.addEventListener("click", function (e) {
        if (!panel.classList.contains("is-open")) return;
        if (panel.contains(e.target) || menuBtn.contains(e.target)) return;
        panel.classList.remove("is-open");
      });

      // 스크롤 내리면 자동으로 닫기 (원하면 제거해도 됨)
      window.addEventListener("scroll", function () {
        if (panel.classList.contains("is-open")) {
          panel.classList.remove("is-open");
        }
      });
    })();
  </script>
</body>

</html>